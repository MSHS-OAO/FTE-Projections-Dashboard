---
title: MSHS FTE Dashboard
author: Health System Operations
date: '`r Sys.Date()`'
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---

```{r, echo=F,warning=F,message=F,results='hide'}
library(dplyr)
library(ggplot2)
library(plotly)

##Reload Master##########################################################################
System_Summary <- readRDS("J:/deans/Presidents/SixSigma/MSHS Productivity/Productivity/Analysis/FTE Projections Dashboard/System Summary/System_Summary.rds")
System_Summary <- System_Summary %>%
  filter(PP.END.DATE >= as.Date("12/22/2019",format="%m/%d/%Y"))
#########################################################################################

#Worked hour pay code mappings
worked <- c("REGULAR","OVERTIME","OTHER_WORKED")
#Site Based Service List
MSH_service_list <- list("ICU","Labor & Delivery","Mother/Baby","Progressive","Med/Surg","Psych","RETU", "Perioperative Services","Support Services","Pharmacy","Radiology","Lab","Emergency Department")
MSQ_service_list <- list("ICU","Med/Surg","Perioperative Services","Support Services","Pharmacy","Radiology","Emergency Department")
MSBI_service_list <- list("ICU","Progressive","Med/Surg","Psych","RETU","Perioperative Services","Support Services","Pharmacy","Radiology","Lab","Emergency Department")
MSB_service_list <- list("ICU","Progressive","Med/Surg","Perioperative Services","Support Services","Pharmacy","Radiology","Lab","Emergency Department")
MSW_service_list <- list("ICU","Labor & Delivery","Mother/Baby","Progressive","Med/Surg","Psych","Perioperative Services","Support Services","Pharmacy","Radiology","Lab","Emergency Department")
MSM_service_list <- list("ICU","Progressive","Med/Surg","Psych","Perioperative Services","Support Services","Pharmacy","Radiology","Lab","Emergency Department")
site_list <- list("MSH","MSQ","MSBI","MSB","MSW","MSM")

#Pre filter data 
data <- System_Summary %>%
  filter(PP.END.DATE < as.Date("3/1/2020",format="%m/%d/%Y") | #date must be earlier than 3/1/2020
         PP.END.DATE >as.Date("5/9/2020",format="%m/%d/%Y"),   #or greater than 5/9/2020
         PROVIDER == 0, #remove providers
         INCLUDE.HOURS == 1, #only use included hour paycodes
         PAY.CODE.MAPPING %in% worked) %>% #remove unproductive paycodes 
  group_by(PAYROLL,DEFINITION.CODE,DEFINITION.NAME,SERVICE.LINE,PP.END.DATE) %>%
  summarise(FTE = round(sum(HOURS, na.rm = T)/75,2)) %>% #calculate FTE
  mutate(DEPARTMENT = paste0(DEFINITION.CODE," - ",toupper(DEFINITION.NAME)), #capitalize department
         DATES = as.character(PP.END.DATE)) %>% #add character form of data
  arrange(PP.END.DATE) #arrange by pay period end date


# Mount Sinai corporate colors "USE THIS TO ADD COLORS"
MountSinai_colors <- c(
  `light pink`   = "#fcc9e9",
  `med pink`     = "#fa93d4",
  `dark pink`    = "#d80b8c",
  `light purple` = "#c7c6ef",
  `med purple`   = "#8f8ce0",
  `light blue`   = "#5cd3ff",
  `med blue`     = "#06ABEB",
  `dark blue`    = "#212070",
  `light grey`   = "#b2b3b2",
  `dark grey`    = "#686868",
  `yellow`       = "#E69F00"
)

# Function to extract Mount Sinai colors as hex codes
# Use Character names of MountSinai_colors

MountSinai_cols <- function(...) {
  cols <- c(...)

  if (is.null(cols))
    return (MountSinai_colors)

  MountSinai_colors[cols]
}

# Create palettes
MountSinai_palettes <- list(
  `all`   = MountSinai_cols("med blue","dark pink","dark blue","light grey", "light blue",
                            "light pink", "light purple","med pink","med purple","yellow" ),

  `main`  = MountSinai_cols("med blue","dark pink","dark blue","dark grey","light pink","light blue","light grey"),

  `pink`  = MountSinai_cols("light pink", "dark pink"),

  `blue`  = MountSinai_cols("light blue", "dark blue"),

  `grey`  = MountSinai_cols("light grey", "med blue")

)
MountSinai_palettes

MountSinai_pal <- function(palette = "main", reverse = FALSE, ...) {
  pal <- MountSinai_palettes[[palette]]

  if (reverse) pal <- rev(pal)

  colorRampPalette(pal, ...)
}

#Service Line Graphs
service_line <- function(hosp,service){
  library(tidyr)
  data_service <- data %>% #take pre-filtered data
    filter(PAYROLL == hosp, #filter on specific hospital
           SERVICE.LINE == service) #filter on specific service line
  data_service <- data_service %>% 
    pivot_wider(id_cols = c("DEFINITION.CODE","DEFINITION.NAME","DEPARTMENT"),
                names_from = "PP.END.DATE",
                values_from = FTE) #pivot dataframe to bring in NAs for missing PP
  data_service <- data_service %>% 
    pivot_longer(cols = 4:ncol(data_service),
                 names_to = "PP.END.DATE") #pivot dataframe to original form
  data_service <- data_service %>% 
    mutate(FTE = case_when(
              is.na(value) ~ 0, #if FTE is NA -> 0
              !is.na(value) ~ value), #else leave the value
           DATES = as.factor(PP.END.DATE)) #turn dates into factor
  data_service$DATES <- factor(data_service$DATES)
  service_line_graph <- ggplot(data = data_service, aes(x=DATES,y=FTE,group=DEPARTMENT,color=DEPARTMENT))+
    geom_line(size=1.5)+
    geom_point(size=2.75)+
    ggtitle(paste(hosp,service,"FTE's By Pay Period"))+
    xlab("Pay Period")+
    ylab("FTE (Full Time Equivalent)")+
    scale_color_manual(values=MountSinai_pal("main")(length(unique(data_service$DEFINITION.CODE))))+
    theme(plot.title=element_text(hjust=.5,size=20),
          axis.title = element_text(face="bold"),
          legend.text=element_text(size = 6)) #create and style service line graph
  service_line_graphly <- ggplotly(service_line_graph,
         tooltip=c("group","x","y")) %>%
    layout(title = list(xanchor = "center")) #turn graph into plotly interactive
  return(service_line_graphly)
}

#Kable
k <- function(hosp,service){
  library(tidyr)
  kdata <- data %>% 
    filter(PAYROLL == hosp, 
           SERVICE.LINE == service) %>% 
    pivot_wider(id_cols = c(SERVICE.LINE,DEPARTMENT),
                names_from = DATES,
                values_from = FTE) 
  kdata[is.na(kdata)] <- 0 
  colnames(kdata)[1] <- "SERVICE LINE" 
  sort <- colnames(kdata)[ncol(kdata)] 
  kdata <- kdata %>% ungroup() %>% arrange(desc(!!sym(sort))) 
  Ktable <<- kdata 
}
```

## `r site_list[[1]]`
### `r MSH_service_list[[1]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[1]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[1]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[2]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[2]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[2]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c") %>%
  column_spec(1,bold = T) %>%
  collapse_rows(1)
```
### `r MSH_service_list[[3]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[3]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[3]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c") %>%
  column_spec(1,bold = T) %>%
  collapse_rows(1)
```
### `r MSH_service_list[[4]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[4]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[4]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[5]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[5]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[5]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[6]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[6]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[6]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[7]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[7]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[7]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[8]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[8]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[8]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[9]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[9]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[9]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[10]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[10]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[10]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[11]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[11]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[11]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[12]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[12]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[12]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSH_service_list[[13]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[1]], service = MSH_service_list[[13]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[1]], service = MSH_service_list[[13]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
## `r site_list[[2]]`
### `r MSQ_service_list[[1]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[2]], service = MSQ_service_list[[1]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[2]], service = MSQ_service_list[[1]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSQ_service_list[[2]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSQ_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[2]], service = MSQ_service_list[[2]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[2]], service = MSQ_service_list[[2]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSQ_service_list[[3]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSQ_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[2]], service = MSQ_service_list[[3]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[2]], service = MSQ_service_list[[3]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSQ_service_list[[4]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSQ_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[2]], service = MSQ_service_list[[4]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[2]], service = MSQ_service_list[[4]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSQ_service_list[[5]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSQ_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[2]], service = MSQ_service_list[[5]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[2]], service = MSQ_service_list[[5]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSQ_service_list[[6]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSQ_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[2]], service = MSQ_service_list[[6]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[2]], service = MSQ_service_list[[6]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSQ_service_list[[7]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSQ_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[2]], service = MSQ_service_list[[7]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[2]], service = MSQ_service_list[[7]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
## `r site_list[[3]]`
### `r MSBI_service_list[[1]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[1]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[1]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[2]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[2]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[2]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[3]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[3]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[3]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[4]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[4]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[4]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[5]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[5]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[5]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[6]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[6]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[6]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[7]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[7]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[7]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[8]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[8]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[8]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[9]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[9]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[9]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[10]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[10]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[10]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSBI_service_list[[11]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[3]], service = MSBI_service_list[[11]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[3]], service = MSBI_service_list[[11]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
## `r site_list[[4]]`
### `r MSB_service_list[[1]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[1]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[1]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[2]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[2]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[2]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[3]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[3]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[3]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[4]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[4]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[4]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[5]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[5]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[5]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[6]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[6]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[6]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[7]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[7]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[7]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[8]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[8]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[8]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSB_service_list[[9]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[4]], service = MSB_service_list[[9]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[4]], service = MSB_service_list[[9]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
## `r site_list[[5]]`
### `r MSW_service_list[[1]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[1]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[1]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[2]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[2]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[2]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[3]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[3]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[3]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[4]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[4]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[4]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[5]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[5]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[5]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[6]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[6]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[6]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[7]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[7]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[7]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[8]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[8]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[8]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[9]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[9]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[9]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[10]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[10]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[10]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[11]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[11]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[11]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSW_service_list[[12]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[5]], service = MSW_service_list[[12]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[5]], service = MSW_service_list[[12]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
## `r site_list[[6]]`
### `r MSM_service_list[[1]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[1]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[1]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[2]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[2]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[2]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[3]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[3]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[3]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[4]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[4]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[4]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[5]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[5]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[5]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[6]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[6]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[6]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[7]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[7]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[7]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[8]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[8]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[8]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[9]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[9]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[9]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```
### `r MSM_service_list[[10]]`
```{r, echo=F,warning=F,message=F,fig.width=12}
#lapply(MSH_service_list,function(x)service_line(hosp="MSH",service=x))
service_line(hosp = site_list[[6]], service = MSM_service_list[[10]])
```

```{r, echo=F,warning=F,message=F}
library(knitr)
library(kableExtra)
k(hosp = site_list[[6]], service = MSM_service_list[[10]])
kable(Ktable) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%
  row_spec(0, background = "#212070", color = "white") %>%
  row_spec(1:nrow(Ktable), color = "black") %>%
  row_spec(0:nrow(Ktable), align = "c", font_size = 11) %>%
  column_spec(1,bold = T) %>%
  column_spec(3:ncol(Ktable),width = "30em") %>%
  collapse_rows(1)
```